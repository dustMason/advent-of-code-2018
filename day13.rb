Cart = Struct.new(:dir, :x, :y, :turns) do
  def up
    raise if dir[1] != 0
    self.y -= 1
    self.dir = [0, -1]
  end

  def down
    raise if dir[1] != 0
    self.y += 1
    self.dir = [0, 1]
  end

  def right
    raise if dir[0] != 0
    self.x += 1
    self.dir = [1, 0]
  end

  def left
    raise if dir[0] != 0
    self.x -= 1
    self.dir = [-1, 0]
  end

  def straight
    self.x += dir[0]
    self.y += dir[1]
  end

  def turn!
    turn = [:left, :straight, :right][turns % 3]
    case turn
    when :straight
      straight
    when :left
      case dir
      when [0, -1] then left
      when [0, 1] then right
      when [-1, 0] then down
      when [1, 0] then up
      else raise
      end
    when :right
      case dir
      when [0, -1] then right
      when [0, 1] then left
      when [-1, 0] then up
      when [1, 0] then down
      else raise
      end
    else raise
    end
    self.turns += 1
  end
end

input = DATA.read

junctions = {}
corners = {}
carts = []

def print(board, carts, corners)
  lines = board.tr('<>', '-').tr('v^', '|').lines
  carts.each do |cart|
    symbol = case cart.dir
             when [1, 0] then '>'
             when [-1, 0] then '<'
             when [0, 1] then 'v'
             when [0, -1] then '^'
             end
    lines[cart.y][cart.x] = symbol
  end
  puts lines
  puts "..."
end

input.each_line.with_index do |line, j|
  line.each_char.with_index do |char, i|
    case char
    when '/'
      if line[i+1] && (%w[- + < >].include?(line[i+1]))
        corners[[i, j]] = :top_left
      else
        corners[[i, j]] = :bottom_right
      end
    when '\\'
      if line[i+1] && (%w[- + < >].include?(line[i+1]))
        corners[[i, j]] = :bottom_left
      else
        corners[[i, j]] = :top_right
      end
    when '-', '>', '<'
      if char == '>'
        carts << Cart.new([1, 0], i, j, 0)
      elsif char == '<'
        carts << Cart.new([-1, 0], i, j, 0)
      end
    when '|', '^', 'v'
      if char == '^'
        carts << Cart.new([0, -1], i, j, 0)
      elsif char == 'v'
        carts << Cart.new([0, 1], i, j, 0)
      end
    when '+'
      junctions[[i, j]] = true
    when ' ', "\n"
    else raise char
    end
  end
end

loop do
  carts.sort_by! { |c| [c.y, c.x] }
  carts.each do |cart|
    if junctions[[cart.x, cart.y]]
      cart.turn!
    else
      if (corner = corners[[cart.x, cart.y]])
        case corner
        when :top_right
          if cart.dir[1] == -1 then cart.left else cart.down end
        when :bottom_right
          if cart.dir[1] == 1 then cart.left else cart.up end
        when :bottom_left
          if cart.dir[0] == -1 then cart.up else cart.right end
        when :top_left
          if cart.dir[1] == -1 then cart.right else cart.down end
        else raise
        end
      else
        cart.straight
      end
    end

    if carts.size == 1
      puts carts
      exit
    end

    if other = (carts - [cart]).find { |other_cart| other_cart.x == cart.x && other_cart.y == cart.y }
      puts "collision at #{cart}, removing #{cart} and #{other}"
      carts -= [cart, other]
      # exit
    end

  end
  # print(input, carts, corners)
end

__END__
                                              /--------------------------------------------------------------------------------\
                                      /-------+--------------------------------------------------------------------------------+-\
   /----------------------------------+-------+-----------------\     /--------\                                               | |
   |                                  |       |/----------------+-----+--\     |                                               | |     /------------\
   |                         /--------+-------++-------------<--+-----+--+-----+-----------------------------\  /--------------+-+-----+-\          |
   |  /----------------------+--------+-------++----------\     |     | /+-----+----\          /-------------+-\|       /------+-+---\ | |          |
   |  |                      |   /----+-------++----------+-----+-----+-++-----+----+----------+-------------+-++-------+------+-+\  | | |          |
   |  |                      |   |/---+-------++----------+-----+\    | ||     | /--+----------+------------\| ||       |      | ||  | | |          |
   |  |                      |   ||   |       ||          |     ||    | ||     | |  |     /----+------------++-++-------+------+-++--+-+\|          |
   |  |              /-------+---++---+-------++----------+-----++----+-++----\| |  |     |  /-+------------++-++-------+------+-++--+-+++---\      |
   |  |              | /-----+---++---+-------++----------+-----++----+-++-\  || |  |     |  | |            || ||       |      | ||  | |||   |      |
   |  |              | | /---+---++---+-------++----------+-----++----+\|| |  || |/-+-----+--+-+------------++-++-------+------+-++--+-+++\  |      |
   |  |              | | |   |  /++---+-------++----------+-----++----++++-+--++-++-+-----+--+-+------------++-++-------+------+-++--+\||||  |      |
   |  |              | | |   |  |||   |       ||    /-----+-----++----++++-+--++-++-+-----+--+-+------------++-++-------+------+-++--++++++--+-----\|
   |  |              | | |   |  |||   |       ||    |/----+-----++--\ |||| |  || || |     |  | |            || |\-------+------+-++--++++/|  |     ||
   \--+-->-----------+-+-+---+--+++---+-------++----++----+-----/|  | ||\+-+<-++-++-/     |  | |            || |        |      | ||  |||| |  |     ||
      |      /-------+-+-+---+\ |||   |       ||    ||    |      |  | || | |  || ||       |/-+-+------------++-+--------+------+-++--++++-+--+-\   ||
      |      |       | | |   || ||| /-+-------++----++----+------+--+-++-+-+--++-++-------++-+-+------------++-+--------+------+\||  |||| |  | |   ||
      |      |       | | |   || ||| | |       ||    ||    |      |  | || | |  || ||       || | |            || |        |      ||||  |||| |  | |   ||
      |   /--+-------+-+-+---++-+++-+-+--\    ||    ||    |      |  | || | |  || ||       || | |            || |        |      ||||  |||| |  | |   ||
      |   |  |       | |/+---++-+++-+-+--+----++----++----+------+--+-++\| |  || ||       || | |            || |      /-+------++++-\|||| |  | |   ||
      |   |  |       | ||| /-++-+++-+-+--+----++----++----+------+-\| |||| |  || ||       || | |            || |      | |      |||| ||||| |  | |   ||
      |   |  |       | ||| | || ||| | |  |    |^    ||    |      | || |||| |  || ||       || | | /----------++-+\     | |      |||| ||||| |  | |   ||
      |   | /+-------+-+++-+-++-+++-+-+--+----++----++----+------+-++-++++-+--++-++-------++-+-+\|          || ||     | |      |||| ||||| |  | |   ||
      |   | ||       | ||| | || ||| | |  |    ||    ||    |      |/++-++++-+--++-++-------++-+-+++----------++-++-----+-+------++++-+++++-+--+\|   ||
      |   |/++-------+-+++-+-++-+++-+-+--+----++----++----+------++++-++++-+--++-++-------++-+-+++----------++-++-----+\|      |||| ||||| |  |||   ||
      |   ||||       | ||| | || ||| | \--+----++----++----+------++++-++++>+--++-++-------++-+-+++----------++-++-----+++------++/| ||||| |  |||   ||
      |   ||||       | ||| | ||/+++-+----+----++----++----+------++++-++++-+--++-++-------++-+-+++----------++-++-----+++--\   || | ||||| |  |||   ||
      |   ||||  /----+-+++-+-++++++-+----+----++----++--\ |      |||| |||| |  || ||       || | |||          || ||     |||  |   || | ||||| |  |||   ||
      |   ||||  |    | ||| | |||||| |    |    ||    ||  | |      |||| |||| |  || ||       || | |||          || ||     ||\--+---++-+-+/||| |  |||   ||
      |   ||||  |    | ||| | |||||| |    | /--++----++--+-+------++++-++++-+--++-++-------++-+-+++----------++-++--\  ||   |   || | | ||| |  |||   ||
      |   ||||  |    | ||| | |||||| |    | |  ||    ||  |/+------++++-++++-+--++-++-------++-+-+++----------++-++--+--++---+---++-+-+-+++-+--+++---++\
      |   ||||  |    | ||| | |||||| |    | |  ||   /++--+++------++++-++++-+--++-++-------++-+-+++----------++-++--+--++---+---++-+-+-+++-+-\|||   |||
      |   |||\--+----+-+++-+-+/|||| |    | |  ||   |\+--+++------++++-++++-+--++-++-------++-+-+++----------++-++--+--++---+---++-+-+-+++-+-++++---/||
      v   |||   |    | ||| | | |||| |    | |  ||   | | /+++------++++-++++-+--++-++-------++-+-+++----------++-++--+--++---+---++-+-+-+++-+-++++---\||
  /---+---+++---+--\ | ||| | | |||| |    | |  ||   | | ||||      |||| |||| |  || ||     /-++-+-+++----------++-++--+-\||   |   || | | ||| | ||||   |||
  |   |   |||   |  | | ||| | | |||| |    | |  \+---+-+-++++------++++-++++-+--++-++-----+-++-+-+++----------++-++--+-+++---+---/| | | ||| | ||||   |||
  |   |   |||   |  | | ||| | | |||| |    | |   |   | |/++++------++++-++++-+--++-++-----+-++-+-+++-----\    || ||  | |||   |    | | | ||| | ||||   |||
  |   |   |||   |  | | ||| | | |||| |  /-+-+---+---+-++++++------++++-++++-+--++-++-----+-++\| |||     |    || ||  | |||   |    | | | |\+-+-++++---+/|
  |   |   |||   |  | | ||| | | |||| |  | | |  /+---+-++++++------++++-++++-+--++-++-----+-++++-+++-----+----++-++--+-+++---+----+-+-+-+-+-+\||||   | |
  |   |   |||   |  | | ||| | | |||| |  |/+-+--++---+-++++++------++++-++++-+--++-++-----+-++++-+++-----+----++\||  | |||   |    | | | | | ||||||   | |
  |   |   |||   |  | | ||| | | |||| |  ||| |  ||   | ||||||      |||| |||| |  || ||     | |||| \++-----+----+++/|  | |||   |    | | | | | ||||||   | |
  |  /+---+++---+--+-+-+++-+-+-++++-+--+++-+--++---+-++++++------++++-++++-+--++-++\    | ||||  ||     |    ||| |  | |||   |    | | | | | ||||||   | |
  |  ||   |||   |  | | ||| | |/++++-+--+++-+--++---+-++++++------++++-++++-+--++-+++----+-++++--++-----+--\ ||| |  | |||   |    | | | | | ||||||   | |
  |  ||   \++---+--+-+-+++-+-++++++-+--++/ |  ||   | ||||||      |||| |||| |  || |||    | ||||  ||     |  | ||| |  | |||   |    | | | | | ||||||   | |
  |  ||    ||   |  | | ||| | |||||| |  ||  |  ||   | ||||||      |||| |||| |  || \++----+-++++--++-----+--+-/|| |  | |||   |    | | | | | ||||||   | |
  |  ||    ||   |  | | ||| | |||||| | /++--+--++---+-++++++------++++-++++-+--++--++----+-++++--++-----+--+--++-+--+-+++--\|    | | | | | ||||||   | |
  |  ||    || /-+--+-+-+++-+-++++++-+-+++--+--++---+-++++++------++++-++++-+--++--++----+-++++--++-----+--+\ || |  | |||  ||    | | | | | ||||||   | |
  | /++----++-+-+--+-+-+++-+-++++++-+-+++--+--++---+-++++++--\   |||| |||| |  ||  ||    | |\++--++-----+--++-++-+--+-+++--++----+-+-+-+-+-+++++/   | |
  | |||    || | |  | | ||| | |||||| | |||  |  ||   | ||||||  |   |||| |||| |  ||  \+----+-+-++--++-----+--++-++-+--+-+++--++----+-+-+-+-+-/||||    | |
  | |||    || | |  | | ||| | |||||| | |||  |  ||   | ||||||  |   |||| |||| |  ||   |    | | ||  ||     |  || || v  | |||  ||    | | | | |  ||||    | |
  | |||    || | |  | | ||| | |||||| | |||  |  ||   | \+++++--+---+++/ |||| |  ||   |    | | ||  |\-----+--++-++-/  | |||  ||    | | | | |  ||||    | |
  \-+++----++-+-+--/ | ||| | |||||| | |||  |  ||   |  |||||  |/--+++--++++-+--++--\|    | | ||  |      |/-++-++----+-+++--++----+-+-+-+-+--++++-\  | |
    |||    || | | /--+-+++-+-++++++-+-+++--+--++---+--+++++-\||  |||  |||| |  ||  ||    | | ||  |      || |v ||    | |||  ||    | | | | |  |||| |  | |
    |||    || | | |  \-+++-+-++++++-+-+++--+--++---+--+++++-+++--+++--++++-+--/|/-++----+-+-++--+------++-++-++----+-+++--++-\  | | | | |  |||| |  | |
    |||    || | | |    ||| | \+++++-+-+++--+--++---+--+++++-+++--+++--++++-+---++-++----+-+-++--+------++-++-/|    | |||  || |  | | | | |  |||| |  | |
    |||    || | | |    |||/+--+++++-+-+++--+--++---+--+++++-+++--+++--++++-+---++-++----+-+-++--+------++-++--+----+-+++--++-+--+-+-+\| v  |||| |  | |
    |||    || | | |    |||||  ||||| | |||  |  ||   |  ||||| |||  |||  |||| |   || ||    | | || /+------++-++--+----+-+++--++-+--+-+-+++-+--++++-+-\| |
    |||    || | | |    |||||  ||||| | |||  |  ||   |  ||||| |||  |||  |||| | /-++-++----+-+-++-++-----\|| ||  | /--+-+++--++-+--+\| ||| |  |||| | || |
  /-+++----++-+-+-+----+++++--+++++-+-+++--+--++---+\ ||||| |||  |||  |||| | | || ||    | | |\-++-----+++-++--+-+--+-+++--++-+--+++-+++-+--++/| | || |
  | |||    || | | |    |||||  ||||| | |||  |  ||   || ||||| |||  |||  |||| | | || || /--+-+-+--++-----+++-++--+-+--+-+++--++-+--+++-+++-+--++-+-+-++\|
/-+-+++----++-+-+-+----+++++--+++++-+-+++--+--++---++-+++++-+++--+++--++++\| | || || |  | | |  ||     ||| ||  | |  | |||  || |  ||| ||| |  || | | ||||
| | |||    || | | |    |\+++--+++++-+-+++--+--++---++-+++++-+++--+++--++/||| | || || |  | | |  ||     ||| ||  | |  | |||  || |  ||| ||| |  || | | ||||
|/+-+++----++\| | |    | |||  ||||| | |||  |  ||   || ||||| |||  |||  ||/+++-+-++-++-+--+-+-+--++-----+++-++--+-+--+-+++-\|| |  ||| ||| |  || | | ||||
||| |||   /++++-+-+----+-+++--+++++-+-+++\ |  ||/--++-+++++-+++--+++--++++++-+-++-++-+--+\| |  ||     ||| ||  | |  | ||| ||| |/-+++-+++-+\ || | | ||||
||| |||   ||||| | |    | |||  ||||| | |||| |  |||  || ||||| |||  |||  |||||| | || || |  ||\-+--++-----+++-++--+-+--+-+++-+++-++-+++-+++-/| || | | ||||
||| |||   ||||| | |    | |||  ||||| | |||| |  |||  || ||||| |||  |||  |||||| | || || |  ||  |  ||     ||| ||  | |  | ||| ||| || ||| |||  | || | | ||||
||| |||   ||||| | |    | |||  ||||| | |||| |  |||  || ||||| |||  |||  \+++++-+-/| || |  ||  |  ||   /-+++-++--+-+--+-+++-+++-++-+++\|||  | || | | ||||
||| |||   ||||| | |    | ||\--+++++-+-++++-+--+++--++-+++++-+++--++/   ||||| |  | || |  ||  |  ||   | ||| ||  | |  | ||| ||| || |||||||  | || | | ||||
||| |||  /+++++-+-+----+-++---+++++-+-++++-+\ |||  || |\+++-+++--++----+++++-+--+-++-+--++--+--++---+-+++-++--+-+--+-+++-+++-++-+++++++--+-++-+-+-+/||
||| |||  |||||| | |    | ||   ||||| | |||| || |||  || | ||| |||  ||    |||||/+--+-++-+--++--+--++--\| ||| ||  | |  | ||| ||| || |||||||  | || | | | ||
||| |||  |||||| | |    | ||   ||||| | |||| ||/+++--++-+-+++-+++--++----+++++++--+\|| \--++--+--++--++-+++-++--+-+--+-+++-+++-++-+++++++--+-++-+-+-+-/|
||| |||  |||||| | |    | || /-+++++-+-++++-++++++--++-+-+++-+++--++----+++++++--++++----++--+--++--++-+++-++--+-+--+\||| ||| || |||||||  | || | | |  |
||| |||  |||||| | |    | || | ||||| | |||| ||||||  || | ||| |||  ||    |||||||  |||| /--++--+--++--++-+++-++\ | |  ||||| ||| || |||||||  | || | | |  |
||| |||  |||||| | |    | || | ||||| | |||| ||||||  || | ||| |||  ||    |||||||  |||| |  ||  |  ||  || ||| ||| | |  ||||| ||| || |||||||  | || | | |  |
||| |||  |||||| | |    | || | ||||| | |||| ||||||  || | ||| |||  ||    |||||||  |||| |  ||  |  ||  || ||| ||| | | /+++++-+++-++-+++++++--+-++-+\| |  |
||| |||  |||||| | |    | || | ||||| | |||| |||||\--++-+-+++-+++--++----+++++++--++++-+--+/  |  ||  || ||| ||| | |/++++++-+++-++\|||||||  | || ||| |  |
||| |||  |||||| | |    | || | ||||| | |||| |||||   || | ||| |||  |\----+++++++--++++-+--+---+--++--++-+++-+++-+-++++++++-+++-++++++++++--+-++-/|| |  |
||| |||  |||||| | |/---+-++-+-+++++-+-++++-+++++---++-+-+++-+++--+----\|||||||  |||| |  |   |  ||  || ||| ||| | |||||||| ||| ||||||||||  | ||  || |  |
||| |||  |||||| | ||   | || | ||||| | |||| |||||   || | ||| |||  |    ||||||||  |||| |  |   |  ||  || ||| ||| | |||||||| ||| ||||||||||  | ||  || |  |
||| |||  |||||| | ||   | \+-+-+++++-+-++++-+++++---++-+-+++-+++--+----+/||||||  ||||/+--+---+--++--++-+++-+++-+-++++++++\||| ||||||||||  |/++--++-+-\|
||| |||  |||||| | ||   |  | | ||||| | |||| |||||   || | ||| |||  |    | ||||||  ||||||  |   |  ||  || ||| ||| | |||||||||||| ||||||||||  ||||  || | ||
||| |||  |||||| | ||   |  | | ||||| | |||| |||||   || | ||| |||  |    | ||||||  ||||||  |   |  ||  || |||/+++-+-++++++++++++-++++++++++--++++\ || | ||
||| |||  |||||| | ||   |  | | ||||| \-++++-+++++---++-+-+++-+++--+----+-++++++--++++++--+---+--++--++-+++++++-+-++++++++++++-+++/||||||  ||||| || | ||
||| |||  |||||| | ||   |  | | ||||| /-++++-+++++-\ || | ||| |||  |    | ||||||  ||||||  |   |  ||  || ||||||| | |||||||||||| ||| ||||||  ||||| || | ||
||| |||  |||||| | ||   |  | | |||\+-+-++++-+++++-+-++-+-+++-+++--+----+-++++++--++++++--+---+--++--++-+++++++-+-++++++++++++-+++-+/||||  ||||| || | ||
||| |||  |||v|| | ||   |  | | ||| | | |||| ||||| | || | ||| |||  |    | ||||||  ||||||  |   |  ||  || ||||||| | |||||||||||| ||| | ||||  ||||| || | ||
||| |||  |||||| | ||   |  \-+-+++-+-+-++++-+++++-+-++-+-+++-+++--+----+-++++++--++++++--+---+--++--++-+++++++-+-++++++++++++-+++-+-++/|  ||||| || | ||
||| |||  |||||| \-++---+----+-+++-+-+-++++-+++++-+-++-+-/|| |||  |    | ||||||  ||||||  |/--+--++--++-+++++++-+-++++++++++++-+++-+-++-+\ ||||| || | ||
||| |||  ||\+++---++---+----+-+++-+-+-++++-+++++-+-++-+--++-+++--+----+-++++++--++++++--++--+--++--++-+++++++-+-+++++++/|||| ||| | || || ||||| || | ||
|||/+++--++-+++---++---+----+-+++-+-+-++++-+++++-+-++\|  || |||  |    |/++++++--++++++--++--+--++--++-+++++++-+-+++++++-++++\||| | || || ||||| || | ||
|||||||  || |||   ||   |    | ||| | | |||| ||||\-+-++++--++-+++--+----+++/||||  ||||||  ||  |  ||  || ||||||| | ||||||| |||||||| | || || ||||| || | ||
|||||||  || |||   ||   |    | ||\-+-+-++++-++++--+-++++--++-+++--+----+++-++++--++++++--++--+--++--++-+++++++-+-+++++++-++++++++-+-++-/| ||||| || | ||
|||||||  || |||/--++---+--\ | ||  \-+-++++-++++--+-++++--++-+++--/    ||| ||||  ||||||  ||  |  ||  || ||||||| | ||||||| |||||||| | ||  | ||||| || | ||
|||||||  || ||||  ||   |  | | ||    | |||| ||||  | ||||  \+-+++-------+++-++++--++++++--++--+--++--++-+++++++-+-+++++++-++++++++-+-++--+-+++++-++-+-+/
|||||||  || ||||  ||   |  | | ||    |/++++-++++--+-++++--\| ||\------<+++-++++--++/|||  ||  |  ||  || ||||||| | ||||||| |||||||| | ||  | ||||| || | |
|||||||  || ||||  ||   |  | |/++----++++++-++++--+-++++--++-++--------+++-++++--++-+++--++--+--++--++-+++++++-+\||||||| |||||||| | ||  | ||||| || | |
|||||||  || ||||  ||   |  | ||||    |||||| |||\--+-++++--++-++--------+++-++++--++-+++--++--+--++--++-+++++++-+++++++++-++++++++-+-++--+-++/|| || | |
|||||||  || ||||  ||   |  | ||||    |||||| |||   | ||||  || ||        ||| ||||  || |||  ||  |  ||  || ||||||| ||||||||| |||||||| | ||  | || || || | |
|||||||  || ||||  ||   |  |/++++----++++++-+++---+-++++--++-++---\    ||| ||||  || |||  |\--+--++--++-+++++++-+++++++++-++++++++-+-++--/ || || || | |
|||||||  || ||||  ||   |  ||||||    ||\+++-+++---+-++++--++-++---+----+++-++++--++-+++--+---+--++--++-+++++++-+++++++++-++/||||| | ||    v| || || | |
||||\++--++-++++--++---+--++++++----++-+++-+++---+-++++--++-+/   |    ||| |||| /++-+++--+---+--++--++-+++++++-+++++++++-++-+++++-+\||    || || || | |
|||| ||  || ||||  ||   |  ||||||    || ||| |||   | ||||  ||/+----+----+++-++++-+++-+++--+---+--++--++-+++++++-+++++++++-++-+++++-++++>---++-++\|| | |
|||| ||  || ||||  ||   |  ||\+++----++-+++-+++---+-++++--++++----+----+++-++++-+++-+++--+---+--++--++-+++++++-++++++/|| || ||||| ||||    || ||||| | |
|||| ||  || ||||  ||  /+--++-+++----++-+++-+++---+-++++--++++--\ |    ||| ||\+-+++-+++--+---+--++--/| ||||||| |||||| || || ||||| ||||    || ||||| | |
|||| ||  || ||\+--++--++--++-+++----++-+++-+++---+-++++--++++--+-+----+++-++-+-+++-+++--+---+--++---+-+++++/| |||||| || || ||||| ||||    || ||||| | |
|||| ||  || || |  ||  ||  || |||   /++-+++-+++---+-++++--++++--+\|    ||| || | ||| |||  |   |  ||   | ||||| | ||||\+-++-++-+++++-++++----++-+++/| | |
|||| ||  || || |  ||  ||  || ||\---+++-+++-+++---+-++++--++++--+++----+++-++-+-+++-+++--+---+--++---+-+++++-+-++++-+-++-++-/|||| ||||    || ||| | | |
|||| ||  || || |  ||  ||  || ||    ||| ||| |||   | ||||/-++++--+++----+++-++-+-+++-+++--+---+-\||   | ||||| | |||| | || ||  |v|| ||||    || ||| | | |
|||| ||  || || |  ||  ||  || ||    ||\-+++-+++---+-+++++-/|||  |||    ||| || | ||| |||  |   | |||   | ||||| | |||| | || ||/-++++-++++\   || ||| | | |
|||| ||  || || |  ||  ||  || ||    ||  |\+-+++---+-+++++--+++--+++----+++-++-+-+++-+++--+---+-+++---+-+++++-+-/||| | || ||| |||| |||||   || ||| | | |
|||| ||  || || |  ||  ||  || ||    ||  | | |||   | |||||  |||  |||    ||| || | ||| ||\--+---+-+++---+-+++++-/  ||| | || ||| |||| |||||  /++-+++-+-+\|
|||| |\--++-++-+--++--++--++-++----++--+-+-+++---+-+++++--/||  |||    ||| || | ||| ||   |   | |||   | |||||    ||| | || ||| |||| |||||  ||| ||| | |||
|||| |   || ||/+--++--++--++-++----++--+-+-+++---+-+++++---++--+++---\||| || \-+++-++---+---+-+++---+-/||||    ||| | || ||| |||| |||||  ||| ||| | |||
|||| |   || ||||  ||  ||  || ||    |\--+-+-+++---/ |||||   \+--+++---++++-++---+++-++---+---+-+++---+--++++----+++-+-++-+++-++++-+++++--+++-++/ | |||
||\+-+---++-++++--++--++--++-++----+---+-+-+++-----+/|||    |  |||   |||| ||   \++-++---+---+-+++---+--++++----+++-+-++-+++-++++-+/|||  ||| ||  | |||
|| | |   || |||\--++--++--/| ||    \---+-+-+++-----+-+++----+--+/|   |||| ||    || ||   |   | |||   |  ||||    ||| | || ||| |||| | |||  ||| ||  | |||
|| |/+---++-+++---++--++---+-++--------+-+-+++-----+-+++----+--+-+---++++-++---\|| ||   |   | |||   |  ||||    ||| | || ||| |||| | |||  ||| ||  | |||
|| |||   || |||   ||  |\---+-++--------+-+-+++-----+-+++----+--+-+---++++-+/   ||| ||   |   | |||   |  ||||    ||| | || ||| |||| | |||  ||| ||  | |||
|| |||   || |||   ||/-+----+-++--------+-+-+++-----+-+++----+--+-+---++++-+----+++-++---+---+\|||   |  ||||    ||| | || ||| |||| | |||  ||| ||  | |||
|| \++---++-+++---+++-+----+-++--------+-+-+++-----+-/||    |  | |   |||| |    ||| ||   |   |||||   |  ||||   /+++-+-++-+++-++++-+-+++--+++-++-\| |||
\+--++---++-+++---+++-+----+-++--------+-+-+++-----+--++----+--+-+---++++-/    ||| ||   |   |||||   |  ||||   |||\-+-++-+++-+++/ | |||  ||| || || |||
 |  ||   |\-+++---+++-+----+-++--------+-/ |||     |  ||    |  | |   ||||      ||| ||   |   |||||   |  ||||   |||  | |\-+++-+++--+-+/|  ||| || || |||
 |  ||   |  |||   ||| |    | ||        |   |||     |  ||    |  | |   ||||      ||| ||   \---+++++---+--++++---+++--+-/  ||| |||  | | |  ||| || || |||
 |  ||   |  |||   ||| \----+-++--------+---+++-----+--++----+--/ |   ||||      ||| ||       |||||   |  ||||   |||  |    ||| |||  | | |  ||| || || |||
 |  ||   |  |||   |||      | ||        |   ||\-----+--++----+----+---++++------++/ ||       |||||   |  ||||   |||  |    ||| |||  | | |  ||| || || |||
 |  ||   |  |||   |||      | ||        |   \+------+--++----+----+---++++------++--++-------+++++---+--++++---+++--/    ||| |||  | | |  ||| || || |||
 |  ||   |  |||   |\+------+-++--------+----+------+--++----+----+---+/||      ||  ||       |||||   |  ||||   |||       ||| |||  | | |  ||| || || |||
 |  ||   |  |||   | |      | ||        |    |      |  \+----+----+---+-++----->++--++-------+++++---+--/|||   ||\-------+++-+++--/ | |  ||| || || |||
 |  ||   |  |||   \-+------+-++--------+----+--<---+---+----/    |   | ||      ||  ||       |||||   |   |||   ||        ||| |||    | |  ||| || || |||
 |  ||   |  \++-----+------+-++--------+----+------+---+---------+---+-++------++--++-------++++/   |   \++---++--------+++-+++----+-+--+++-++-+/ |||
 |/-++---+---++-----+------+-++--------+----+------+---+---------+---+-++-----\||  ||       ||||    |    ||   ||        ||\-+++----+-/  ||| || |  |||
 || ||   |   ||     |      | ||        |    |      |   \---------+---+-++-----+++--++-------++/|    |    ||   ||        ||  |||    |    ||| || |  |||
 || ||   |   ||     |      | ||        |    |      \-------------+---+-++-----+++--++-------++-+----+----++---++--------++--+++----+----+++-/| |  |||
 || ||   |   ||     |      | ||        \----+--------------------+---+-++-----+++--++-------/| |    |    ||   ||        ||  |||    |    |||  | |  |||
 || ||   |   ||     |      | ||             |                    |   | ||     |||  |\--------+-+----+----++---++--------/|  |||    |    |||  | |  |||
 || ||   |   ||     \------+-++-------------+--------------------+---+-++-----+++--+---------/ |    |    ||   ||         |  |||    |    |||  | |  |||
 || ||   |   ||            | ||             |   /----------------+---+-++---\ |||  |           |    |    ||   ||         |  |||    |    |||  | |  |||
 || ||   |   ||            \-++-------------+---+----------------/   | \+---+-+++--+-----------+----+----++---++---------+--/||    |    |||  | |  |||
 \+-++---+---/\--------------++-------------+---+--------------------/  |   | |||  |           |    |    ||   ||         |   ||    |    ||\--+-+--++/
  | \+---+-------------------++-------------+---+-----------------------+---+-+/|  |           |    |    ||   ||         |   ||    |    \+---+-+--+/
  |  |   |                   ||             |   |                       \---+-+-+--+-----------+----+----++---++---------/   ||    |     |   | |  |
  |  \---+-------------------++-------------+---+---------------------------+-+-+--/           |    |    \+---++-------------++----+-----+---/ |  |
  |      |                   \+-------------+---+---------------------------+-+-+--------------+----+-----+---+/             |\----+-----/     |  |
  \------+--------------------+-------------+---+---------------------------+-/ |              |    \-----+---+--------------+-----/           |  |
         |                    |             |   |                           |   |              \----------+---+--------------+-----------------+--/
         |                    \-------------+---+-<-------------------------+---+-------------------------/   \--------------+-----------------/
         |                                  |   |                           |   |                                            |
         \----------------------------------/   \---------------------------/   \--------------------------------------------/



